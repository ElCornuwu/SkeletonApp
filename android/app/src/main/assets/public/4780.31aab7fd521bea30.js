"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4780],{4780:(k,p,u)=>{u.r(p),u.d(p,{LoginPageModule:()=>R});var f=u(177),c=u(4341),i=u(4742),d=u(8986),m=u(467),o=u(3953),C=u(3656),h=u(858);const M=["logoWrapper"],_=["logoImage"],b=()=>["/login/registro"],v=[{path:"",component:(()=>{var a;class l{constructor(e,n,r,t,s){this.navCtrl=e,this.alertController=n,this.animationCtrl=r,this.datosService=t,this.alertButtons=["Action"],this.rol="",this.login={usuario:"",password:""},this.router=s}ngAfterViewInit(){this.movementAnimation=this.animationCtrl.create().addElement(this.logoWrapper.nativeElement).duration(500).iterations(1).keyframes([{offset:0,transform:"translateX(0)"},{offset:1,transform:"translateX(300px)"}]),this.rotationAnimation=this.animationCtrl.create().addElement(this.logoImage.nativeElement).duration(500).iterations(1).keyframes([{offset:0,transform:"rotate(0deg)"},{offset:1,transform:"rotate(360deg)"}]).onFinish(()=>{this.alertaInicio("\xc9xito",this.login.usuario+" ha iniciado sesi\xf3n correctamente")})}play(){this.movementAnimation.play(),this.rotationAnimation.play()}ngOnInit(){}ingresar(){""!==this.login.usuario.trim()?""!==this.login.password.trim()?this.datosService.login(this.login.usuario,this.login.password).subscribe({next:e=>{if(e.length>0&&e[0].password===this.login.password){const n=e[0];if(n.token){localStorage.setItem("token",n.token),localStorage.setItem("user",JSON.stringify(n)),this.alertaInicio("\xc9xito",`${this.login.usuario} ha iniciado sesi\xf3n correctamente`);const r=n.rol;"Conductor"===r?this.router.navigate(["/home/administrar-viaje"]):"Pasajero"===r?this.router.navigate(["/home/ruta"]):console.error("Rol no reconocido")}else this.alertaErrorLogin(),console.error("Error de autenticaci\xf3n: No se recibi\xf3 un token")}else this.alertaErrorLogin(),console.error("Usuario o contrase\xf1a incorrectos")},error:e=>{this.alertaErrorLogin(),console.error("Error en el inicio de sesi\xf3n:",e)}}):this.alertaErrorPass():this.alertaErrorUser()}validarRol(){const e=this.datosService.getUserRole();e?"Pasajero"===e?this.router.navigate(["/home/ruta"]):"Conductor"===e?this.router.navigate(["/home/usuario"]):console.error("Rol no reconocido"):console.error("No se pudo obtener el rol del usuario")}valNumPass(e){const r=e.target.value.replace(/[^0-9]/g,"");this.login.password=r,e.target.value=r}alertaInicio(e,n){var r=this;return(0,m.A)(function*(){yield(yield r.alertController.create({header:e,message:n,buttons:["Ok"]})).present()})()}alertaErrorUser(){var e=this;return(0,m.A)(function*(){yield(yield e.alertController.create({header:"ERROR!",subHeader:"Error al iniciar sesi\xf3n",message:"Se debe ingresar un usuario",buttons:["Ok"]})).present()})()}alertaErrorPass(){var e=this;return(0,m.A)(function*(){yield(yield e.alertController.create({header:"ERROR!",subHeader:"Error al iniciar sesi\xf3n",message:"Se debe ingresar la contrase\xf1a",buttons:["Ok"]})).present()})()}alertaErrorLogin(){var e=this;return(0,m.A)(function*(){yield(yield e.alertController.create({header:"ERROR!",subHeader:"Error al iniciar sesi\xf3n",message:"Usuario o contrase\xf1a incorrectos",buttons:["Ok"]})).present()})()}}return(a=l).\u0275fac=function(e){return new(e||a)(o.rXU(C.q9),o.rXU(i.hG),o.rXU(i.Hx),o.rXU(h.n),o.rXU(d.Ix))},a.\u0275cmp=o.VBU({type:a,selectors:[["app-login"]],viewQuery:function(e,n){if(1&e&&(o.GBs(M,5,o.aKT),o.GBs(_,5,o.aKT)),2&e){let r;o.mGM(r=o.lsd())&&(n.logoWrapper=r.first),o.mGM(r=o.lsd())&&(n.logoImage=r.first)}},decls:26,vars:4,consts:[["logoWrapper",""],["logoImage",""],["id","header"],[1,"fomulario"],[1,"form"],[1,"logo-wrapper","ion-text-center"],["src","assets/icon/logo.png","width","170px","alt","Logo"],["labelPlacement","stacked","placeholder","Usuario","maxlength","8",3,"ngModelChange","ngModel"],["slot","start","name","person","aria-hidden","true"],["type","password","placeholder","Contrase\xf1a","maxlength","4",3,"ngModelChange","ionInput","ngModel"],["slot","start","name","lock-closed","aria-hidden","true"],["slot","end"],["expand","block","shape","round",3,"click"],[1,"registro"],["expand","block","shape","round",3,"routerLink"],[1,"ion-text-center",2,"margin-top","10px"],["href","/recuperar"]],template:function(e,n){if(1&e){const r=o.RV6();o.j41(0,"ion-content")(1,"router-outlet"),o.nrm(2,"div",2),o.j41(3,"div",3)(4,"ion-card",4)(5,"ion-card-content")(6,"div",5,0),o.nrm(8,"img",6,1),o.k0s(),o.j41(10,"ion-item")(11,"ion-input",7),o.mxI("ngModelChange",function(s){return o.eBV(r),o.DH7(n.login.usuario,s)||(n.login.usuario=s),o.Njj(s)}),o.nrm(12,"ion-icon",8),o.k0s()(),o.j41(13,"ion-item")(14,"ion-input",9),o.mxI("ngModelChange",function(s){return o.eBV(r),o.DH7(n.login.password,s)||(n.login.password=s),o.Njj(s)}),o.bIt("ionInput",function(s){return o.eBV(r),o.Njj(n.valNumPass(s))}),o.nrm(15,"ion-icon",10)(16,"ion-input-password-toggle",11),o.k0s()(),o.j41(17,"ion-button",12),o.bIt("click",function(){return o.eBV(r),o.Njj(n.ingresar())}),o.EFF(18,"Ingresar"),o.k0s()()(),o.j41(19,"ion-card",13)(20,"ion-card-content")(21,"ion-button",14),o.EFF(22,"Registrate"),o.k0s(),o.j41(23,"div",15)(24,"a",16),o.EFF(25,"Recuperar contrase\xf1a"),o.k0s()()()()()()()}2&e&&(o.R7$(11),o.R50("ngModel",n.login.usuario),o.R7$(3),o.R50("ngModel",n.login.password),o.R7$(7),o.Y8G("routerLink",o.lJ4(3,b)))},dependencies:[c.BC,c.tU,c.vS,i.Jm,i.b_,i.I9,i.W9,i.iq,i.$w,i.Wv,i.uz,i.Gw,i.N7,d.n3,d.Wk],styles:["ion-content[_ngcontent-%COMP%]{--background:white}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]{height:23%;background-color:#105b63;border-radius:0 0 20px 20px;display:column;color:#fff;padding:20px}ion-content[_ngcontent-%COMP%]   .fomulario[_ngcontent-%COMP%]{position:absolute;top:15%;left:4%;right:4%}ion-content[_ngcontent-%COMP%]   .fomulario[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{border-radius:20px;padding:15px 10px}ion-content[_ngcontent-%COMP%]   .fomulario[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-bottom:15px;border-radius:5px}ion-content[_ngcontent-%COMP%]   .fomulario[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:25px}ion-content[_ngcontent-%COMP%]   .registro[_ngcontent-%COMP%]{border-radius:20px}"]}),l})(),children:[{path:"registro",component:(()=>{var a;class l{constructor(e,n,r){this.alertController=e,this.datosService=n,this.router=r,this.nuevoUsuario={nombre:"",mail:"",telefono:"",password:"",rol:""}}ngOnInit(){}registrar(){var e=this;return(0,m.A)(function*(){e.validarFormulario()&&(e.nuevoUsuario.token="1111",e.datosService.registrarUsuario(e.nuevoUsuario).subscribe({next:()=>{e.mostrarAlerta("Registro exitoso","El usuario ha sido creado correctamente."),e.router.navigate(["/login"])},error:n=>{console.error("Error al registrar el usuario:",n),e.mostrarAlerta("Error","Hubo un problema al crear el usuario.")}}))})()}validarFormulario(){const{nombre:e,mail:n,telefono:r,password:t,rol:s}=this.nuevoUsuario;return e.trim()&&n.trim()&&r.trim()&&t.trim()&&s.trim()?/^\S+@\S+\.\S+$/.test(n)?r.length<9?(this.mostrarAlerta("Error","El n\xfamero de tel\xe9fono debe tener al menos 9 d\xedgitos."),!1):!(t.length<4&&(this.mostrarAlerta("Error","La contrase\xf1a debe tener al menos 4 caracteres."),1)):(this.mostrarAlerta("Error","El correo electr\xf3nico no es v\xe1lido."),!1):(this.mostrarAlerta("Error","Todos los campos son obligatorios."),!1)}mostrarAlerta(e,n){var r=this;return(0,m.A)(function*(){yield(yield r.alertController.create({header:e,message:n,buttons:["Ok"]})).present()})()}}return(a=l).\u0275fac=function(e){return new(e||a)(o.rXU(i.hG),o.rXU(h.n),o.rXU(d.Ix))},a.\u0275cmp=o.VBU({type:a,selectors:[["app-registro"]],decls:25,vars:5,consts:[[1,"registro-wrapper"],["labelPlacement","stacked","placeholder","Nombre","maxlength","50",3,"ngModelChange","ngModel"],["labelPlacement","stacked","type","email","placeholder","Correo Electr\xf3nico",3,"ngModelChange","ngModel"],["labelPlacement","stacked","type","tel","placeholder","Tel\xe9fono","maxlength","9",3,"ngModelChange","ngModel"],["labelPlacement","stacked","type","password","placeholder","Contrase\xf1a","maxlength","8",3,"ngModelChange","ngModel"],["placeholder","Selecciona tu rol",3,"ngModelChange","ngModel"],["value","Pasajero"],["value","Conductor"],["expand","block","shape","round",3,"click"],["expand","block","shape","round","fill","outline","routerLink","/login"]],template:function(e,n){1&e&&(o.j41(0,"ion-content")(1,"div",0)(2,"ion-card")(3,"ion-card-header")(4,"ion-card-title"),o.EFF(5,"Crear Usuario"),o.k0s()(),o.j41(6,"ion-card-content")(7,"ion-item")(8,"ion-input",1),o.mxI("ngModelChange",function(t){return o.DH7(n.nuevoUsuario.nombre,t)||(n.nuevoUsuario.nombre=t),t}),o.k0s()(),o.j41(9,"ion-item")(10,"ion-input",2),o.mxI("ngModelChange",function(t){return o.DH7(n.nuevoUsuario.mail,t)||(n.nuevoUsuario.mail=t),t}),o.k0s()(),o.j41(11,"ion-item")(12,"ion-input",3),o.mxI("ngModelChange",function(t){return o.DH7(n.nuevoUsuario.telefono,t)||(n.nuevoUsuario.telefono=t),t}),o.k0s()(),o.j41(13,"ion-item")(14,"ion-input",4),o.mxI("ngModelChange",function(t){return o.DH7(n.nuevoUsuario.password,t)||(n.nuevoUsuario.password=t),t}),o.k0s()(),o.j41(15,"ion-item")(16,"ion-select",5),o.mxI("ngModelChange",function(t){return o.DH7(n.nuevoUsuario.rol,t)||(n.nuevoUsuario.rol=t),t}),o.j41(17,"ion-select-option",6),o.EFF(18,"Pasajero"),o.k0s(),o.j41(19,"ion-select-option",7),o.EFF(20,"Conductor"),o.k0s()()(),o.j41(21,"ion-button",8),o.bIt("click",function(){return n.registrar()}),o.EFF(22,"Registrar"),o.k0s(),o.j41(23,"ion-button",9),o.EFF(24," Cancelar "),o.k0s()()()()()),2&e&&(o.R7$(8),o.R50("ngModel",n.nuevoUsuario.nombre),o.R7$(2),o.R50("ngModel",n.nuevoUsuario.mail),o.R7$(2),o.R50("ngModel",n.nuevoUsuario.telefono),o.R7$(2),o.R50("ngModel",n.nuevoUsuario.password),o.R7$(2),o.R50("ngModel",n.nuevoUsuario.rol))},dependencies:[c.BC,c.tU,c.vS,i.Jm,i.b_,i.I9,i.ME,i.tN,i.W9,i.$w,i.uz,i.Nm,i.Ip,i.Je,i.Gw,i.N7,d.Wk],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #f2f2f2}.registro-wrapper[_ngcontent-%COMP%]{display:flex}ion-card[_ngcontent-%COMP%]{width:100%;max-width:400px;border-radius:12px}ion-card-header[_ngcontent-%COMP%]{text-align:center;background-color:#105b63;color:#fff;border-top-left-radius:12px;border-top-right-radius:12px;padding:16px}ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700}ion-item[_ngcontent-%COMP%]{--background: transparent;margin-bottom:16px}ion-button[_ngcontent-%COMP%]{margin-top:16px;font-size:1rem;font-weight:700;border-radius:20px}ion-button[_ngcontent-%COMP%]:first-of-type{color:#fff}']}),l})()}]}];let P=(()=>{var a;class l{}return(a=l).\u0275fac=function(e){return new(e||a)},a.\u0275mod=o.$C({type:a}),a.\u0275inj=o.G2t({imports:[d.iI.forChild(v),d.iI]}),l})(),R=(()=>{var a;class l{}return(a=l).\u0275fac=function(e){return new(e||a)},a.\u0275mod=o.$C({type:a}),a.\u0275inj=o.G2t({imports:[f.MD,c.YN,i.bv,P]}),l})()}}]);